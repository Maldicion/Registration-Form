<section fxLayout="column" [class.section]="applyPadding" *ngIf="{isMobile: isMobile$ | async} as data">

    <!-- filter section -->

    <section fxLayout="row" fxLayoutAlign="start" fxLayoutAlign.lt-sm="center">

        <mat-form-field appearance="outline" fxFlex.gt-sm="300px" fxFlex.sm="300px" fxFlex="100%">
            <mat-label>Enter a date range</mat-label>
            <mat-date-range-input [formGroup]="dateRangeFG" [rangePicker]="picker">
              <input matStartDate formControlName="start_date" placeholder="Start date">
              <input matEndDate formControlName="end_date" placeholder="End date">
            </mat-date-range-input>
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker></mat-date-range-picker>
          
            <mat-error *ngIf="dateRangeFG.controls.start_date.hasError('matStartDateInvalid')">Invalid start date</mat-error>
            <mat-error *ngIf="dateRangeFG.controls.end_date.hasError('matEndDateInvalid')">Invalid end date</mat-error>
        </mat-form-field>

    </section>

    <mat-table [dataSource]="topBuyerData">

        <ng-container matColumnDef="loader">
            <mat-header-cell *matHeaderCellDef [style.width.%]="100" fxLayoutAlign="center center">
                <mat-spinner [diameter]="30"></mat-spinner>
            </mat-header-cell>
        </ng-container>

        <ng-container matColumnDef="noData">
            <mat-header-cell *matHeaderCellDef [style.width.%]="100" fxLayoutAlign="center center">
                No Data Found.
            </mat-header-cell>
        </ng-container>

        <!-- <ng-container matColumnDef="id">
            <mat-header-cell *matHeaderCellDef fxFlex="100px"> Id </mat-header-cell>
            <mat-cell *matCellDef="let element; let index = index" fxFlex="100px"> {{ index + 1 }} </mat-cell>
        </ng-container> -->

        <ng-container matColumnDef="name">
            <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{ element.firstName + ' ' + element.lastName }} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="email">
            <mat-header-cell *matHeaderCellDef> Email </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{ element.email }} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="mobile">
            <mat-header-cell *matHeaderCellDef> Mobile </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{ element.mobile }} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="credit_limit">
            <mat-header-cell *matHeaderCellDef fxFlex="100px"> Credit Limit </mat-header-cell>
            <mat-cell *matCellDef="let element" fxFlex="100px"> {{ element.creditLimit }} </mat-cell>
        </ng-container>

        <ng-container matColumnDef="details">
            <mat-header-cell *matHeaderCellDef [style.paddingLeft.px]="8"> Details </mat-header-cell>
            <mat-cell *matCellDef="let element" [style.paddingLeft.px]="8"> 
                <div fxLayout="column">
                    <div fxLayoutGap="5px">
                        <label class="mat-subheading-2"> {{ element.firstName + ' ' + element.lastName }} </label> <label class="mat-caption gray-color"> ({{ element.creditLimit }}) </label>
                    </div>
                    <label class="mat-subheading-1"> {{ element.email }} </label>
                    <label class="mat-body-2"> {{ element.mobile }} </label>
                </div>
            </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="data.isMobile?.mobile ? mobileDisplayedColumns : desktopDisplayedColumns; sticky: true;"></mat-header-row>
        <mat-header-row *matHeaderRowDef="['loader']" fxHide [fxShow]="isApiCalling"></mat-header-row>
        <mat-header-row *matHeaderRowDef="['noData']" fxHide [fxShow]="!isApiCalling && !topBuyerData?.length"></mat-header-row>
        <mat-row *matRowDef="let row; columns: data.isMobile?.mobile ? mobileDisplayedColumns : desktopDisplayedColumns;"></mat-row>

    </mat-table>

    <mat-paginator [length]="100" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]" aria-label="top buyer paginator">
    </mat-paginator>

</section>